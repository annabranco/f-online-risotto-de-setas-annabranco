"use strict";var RECIPE,EXERCISE_URL="https://raw.githubusercontent.com/Adalab/recipes-data/master/rissoto-setas.json",updateTotalCosts=function(){var e=document.querySelectorAll(".recipe-main__value"),t=RECIPE["shipping-cost"],n=0;e.forEach(function(e){return n+=Number(e.innerHTML.slice(0,e.innerHTML.length-1).replace(",","."))}),document.getElementById("subtotal").innerHTML=n.toFixed(2).replace(".",",")+RECIPE.currency,document.getElementById("total").innerHTML=(n+t).toFixed(2).replace(".",",")+RECIPE.currency,document.getElementById("totalButton").innerHTML=(n+t).toFixed(2).replace(".",",")+RECIPE.currency},updateTotalQuantities=function(){var e=document.querySelectorAll(".recipe-main__quantityField"),t=0;e.forEach(function(e){return t+=Number(e.value)}),document.getElementById("quantity").innerHTML=t.toString()},determineCosts=function(e,t){for(var n=0,i=RECIPE.ingredients;n<i.length;n++){var r=i[n];if(r.id===e)return(r.price*t).toFixed(2).replace(".",",")+RECIPE.currency}},buyIt=function(){var e=document.getElementById("total").innerHTML;document.querySelector(".main__wrapper").remove();var t=document.createElement("img");t.setAttribute("src","images/loading.gif"),t.classList.add("pleaseWait");var n=document.createElement("p");n.innerHTML="Procesando tu compra...",n.classList.add("pleaseWaitText");var i=document.createElement("p");i.classList.add("thankU","hidden"),i.innerHTML="El total de "+e+" ha sido debitado de tu tarjeta.\n  Gracias por tu compra.",document.querySelector(".header").append(i,t,n),setTimeout(function(){t.classList.add("hidden"),n.classList.add("hidden"),i.classList.remove("hidden")},4e3)},handleToggleAll=function(e){var t,n=document.querySelectorAll(".recipe-main__checkbox");t="deselect"===e,n.forEach(function(e){return e.checked===t&&e.click()})},handleCheckboxClick=function(e){var t=e.currentTarget.parentElement;e.currentTarget.checked?(t.querySelector(".recipe-main__quantityField").value="1",t.querySelector(".recipe-main__value").innerHTML=determineCosts(t.id,1)):(t.querySelector(".recipe-main__quantityField").value="0",t.querySelector(".recipe-main__value").innerHTML=determineCosts(t.id,0)),updateTotalQuantities(),updateTotalCosts()},handleQuantityInputChange=function(e){var t=e.currentTarget.parentElement,n=t.querySelector(".recipe-main__checkbox"),i=parseFloat(e.currentTarget.value);t.querySelector(".recipe-main__value").innerHTML=determineCosts(t.id,i),!1===n.checked?n.checked=!0:0===Number(i)&&(n.checked=!1),updateTotalQuantities(),updateTotalCosts()},addEventListeners=function(){var e=document.querySelectorAll(".recipe-main__checkbox"),t=document.querySelectorAll(".recipe-main__quantityField"),n=document.getElementById("selectAll"),i=document.getElementById("deselectAll"),r=document.getElementById("buyIt");e.forEach(function(e){e.addEventListener("click",handleCheckboxClick)}),t.forEach(function(e){e.addEventListener("input",handleQuantityInputChange)}),n.addEventListener("click",function(){return handleToggleAll("select")}),i.addEventListener("click",function(){return handleToggleAll("deselect")}),r.addEventListener("click",buyIt)},catchIngredients=function(){var i=document.getElementById("ingredientsList");i.querySelector(".recipe-main__articleDetail-title").innerHTML=RECIPE.ingredients[0].product,i.querySelector(".recipe-main__articleDetail-brand").innerHTML=RECIPE.ingredients[0].brand,i.querySelector(".recipe-main__articleDetail-weigth").innerHTML=RECIPE.ingredients[0].quantity,i.querySelector(".recipe-main__quantityField").value=RECIPE.ingredients[0].items,i.querySelector(".recipe-main__value").innerHTML=Number(RECIPE.ingredients[0].price).toFixed(2).replace(".",",")+RECIPE.currency,RECIPE.ingredients.forEach(function(e,t){if(e.id="ingredient-"+(t+1),0<t){var n=document.querySelector(".recipe-main__ingredient").cloneNode(!0);i.appendChild(n),n.id="ingredient-"+(t+1),n.querySelector(".recipe-main__articleDetail-title").innerHTML=e.product,n.querySelector(".recipe-main__articleDetail-brand").innerHTML=e.brand||"",n.querySelector(".recipe-main__articleDetail-weigth").innerHTML=e.quantity,n.querySelector(".recipe-main__quantityField").value=e.items.toString(),n.querySelector(".recipe-main__value").innerHTML=Number(e.price).toFixed(2).replace(".",",")+RECIPE.currency}}),console.log(RECIPE),addEventListeners()},catchRecipeNameAndDetails=function(){document.getElementById("title").innerHTML=RECIPE.name,document.getElementById("shipping").innerHTML=RECIPE["shipping-cost"].toFixed(2).replace(".",",")+RECIPE.currency},catchData=function(){catchRecipeNameAndDetails(),catchIngredients(),updateTotalQuantities(),updateTotalCosts()},INITIATE=function(){fetch(EXERCISE_URL).then(function(e){return e.json()}).then(function(e){RECIPE=e.recipe,catchData()}).catch(function(e){console.log("Failed when trying to fetch data from servers."),console.log("Reason: ",e),console.log("Serving data from local."),fetch("./scripts/database.json").then(function(e){return e.json()}).then(function(e){RECIPE=e.recipe,catchData()})})};INITIATE();